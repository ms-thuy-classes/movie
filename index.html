<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ms. Thúy - IELTS English</title>
    <style>
        :root {
            --pastel-pink: #ffd1dc;
            --deep-pink: #ffafbd;
            --accent-pink: #ff8fa3;
            --text-color: #4a4a4a;
            --success: #27ae60;
            --danger: #e74c3c;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, var(--pastel-pink), var(--deep-pink));
            color: var(--text-color);
            margin: 0; padding: 20px; min-height: 100vh;
        }

        .container {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 25px;
            max-width: 1600px;
            margin: 0 auto;
        }

        .video-section { position: sticky; top: 20px; }

        .video-container {
            position: relative; padding-bottom: 56.25%; height: 0;
            border: 8px solid white; border-radius: 25px;
            overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        /* Bảng điều khiển & Điểm số */
        .controls-container {
            background: white; margin-top: 20px; padding: 20px;
            border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-align: center;
        }

        .score-display {
            font-size: 1.4em; font-weight: bold; color: #d84361;
            margin-bottom: 15px; display: none;
        }

        .btn-group { display: flex; gap: 10px; justify-content: center; }

        button {
            padding: 12px 25px; border-radius: 25px; border: none;
            font-weight: bold; cursor: pointer; transition: 0.3s;
        }

        .btn-submit { background: #d84361; color: white; }
        .btn-submit:hover { background: #b7324d; transform: scale(1.05); }

        /* Cột Transcript */
        .transcript-section {
            background: rgba(255, 255, 255, 0.9); padding: 30px;
            border-radius: 25px; height: 85vh; overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); scroll-behavior: smooth;
        }

        .sentence {
            padding: 15px; margin-bottom: 20px; border-radius: 15px;
            background: white; line-height: 2.2; border-left: 5px solid transparent;
        }

        .sentence.active { border-left-color: var(--accent-pink); background: #fffafb; }

        /* Input & Key display */
        .input-item { display: inline-flex; align-items: center; gap: 5px; margin: 0 5px; }

        input[type="text"] {
            border: none; border-bottom: 2px solid var(--accent-pink);
            background: #fff0f3; width: 130px; text-align: center;
            font-weight: bold; color: #d84361; border-radius: 5px;
        }

        input.correct { background: #d4edda !important; color: var(--success) !important; border-bottom-color: var(--success); }
        input.wrong { background: #f8d7da !important; color: var(--danger) !important; border-bottom-color: var(--danger); }

        .key-reveal {
            font-size: 0.8em; color: var(--danger); font-weight: bold;
            padding: 2px 6px; border: 1px solid var(--danger); border-radius: 4px;
            background: white; display: none;
        }

        .hint-box { font-size: 0.85em; color: #666; font-style: italic; margin-top: 8px; border-top: 1px dashed #ffd1dc; }

        @media (max-width: 1100px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="container">
    <div class="video-section">
        <div class="video-container"><div id="player"></div></div>
        
        <div class="controls-container">
            <div id="score-text" class="score-display">ĐIỂM CỦA BẠN: 0 / 40 (0%)</div>
            <div class="btn-group">
                <button class="btn-submit" onclick="gradeWork()">NỘP BÀI & KIỂM TRA</button>
                <button style="background: #eee;" onclick="location.reload()">LÀM LẠI</button>
            </div>
        </div>
    </div>

    <div class="transcript-section" id="list"></div>
</div>

<script>
    const quiz = [
        { s: 7, e: 10, t: "Watching a kitten [fumbling] around,", h: "lóng ngóng, vụng về" },
        { s: 10, e: 18, t: "it might feel as if you’ve never [encountered] anything so [devastatingly] adorable in your [mortal] life.", h: "chạm trán - tột cùng - trần thế" },
        { s: 25, e: 35, t: "But you may also feel the [conflicting] [urge] to [squeeze] or smush the kitten.", h: "mâu thuẫn - sự thôi thúc - nựng/bóp" },
        { s: 36, e: 40, t: "However, you don’t. And you might be [appalled] by yourself.", h: "kinh hãi, sốc" },
        { s: 40, e: 51, t: "But this urge, which psychologists call “cute aggression,” is a common [phenomenon] [estimated] to [affect] adults.", h: "hiện tượng - ước tính - ảnh hưởng" },
        { s: 52, e: 57, t: "To better understand this [peculiar] case, let's start with what cuteness is.", h: "kỳ lạ, riêng biệt" },
        { s: 58, e: 67, t: "In 1943, one scientist created a baby [schema] that [identified] key [features].", h: "lược đồ - xác định - đặc điểm" },
        { s: 71, e: 79, t: "These [characteristics] were placed in [opposition] with those [perceived] as less cute.", h: "đặc tính - sự đối lập - nhận thức" },
        { s: 80, e: 87, t: "Decades of study have since [indicated] that this baby schema [reliably] tracks with people.", h: "chỉ ra - một cách đáng tin cậy" },
        { s: 92, e: 104, t: "When study [participants] see images, they [tend] to look at them longer.", h: "người tham gia - có xu hướng" },
        { s: 105, e: 115, t: "Photos appear to [stimulate] brain regions associated with [reward].", h: "kích thích - phần thưởng" },
        { s: 115, e: 125, t: "Cuteness is also thought to [influence] behavior and [emotions].", h: "ảnh hưởng - cảm xúc" },
        { s: 127, e: 135, t: "The fact that cuteness [hijacks] our emotions is not lost on [advertisers].", h: "khống chế - nhà quảng cáo" },
        { s: 135, e: 145, t: "One [theory] is that cute things simply make us want to [nurture] them.", h: "lý thuyết - nuôi dưỡng" },
        { s: 146, e: 154, t: "Because human babies are [relatively] helpless, evolution [favored] cute infants.", h: "tương đối - ưu ái" },
        { s: 155, e: 165, t: "Being [acutely] sensitive, we are [tuned] into similar features in other species.", h: "cực kỳ - nhạy bén" },
        { s: 165, e: 180, t: "As we [domesticated] animals, they adopted more [juvenile] features.", h: "thuần hóa - trẻ con" },
        { s: 181, e: 196, t: "Animals became more [docile]. These changes are [regulated] by neural crest cells.", h: "dễ bảo - điều chỉnh" },
        { s: 255, e: 265, t: "Physical characteristics [distinguish] us from our closest cousins.", h: "phân biệt" },
        { s: 271, e: 289, t: "Cute aggression is [linked] to emotional [overload], not harm [intention].", h: "liên quan - quá tải - ý định" },
        { s: 290, e: 309, t: "It's the brain's way of [regulating] [overwhelming] positive feelings.", h: "điều chỉnh - tràn ngập" },
        { s: 310, e: 327, t: "Cuteness [wields] immense, [consequential] power in our world.", h: "nắm giữ - hệ trọng" }
    ];

    // YT API
    var tag = document.createElement('script'); tag.src = "https://www.youtube.com/iframe_api";
    document.getElementsByTagName('head')[0].appendChild(tag);
    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', { videoId: 'yxsoE3jO8HM', events: { 'onReady': () => { render(); setInterval(sync, 400); } } });
    }

    function render() {
        const list = document.getElementById('list');
        quiz.forEach((item, i) => {
            const div = document.createElement('div');
            div.className = 'sentence'; div.id = 's' + i;
            let text = item.t.replace(/\[(.*?)\]/g, (m, p1) => 
                `<span class="input-item"><input type="text" data-ans="${p1}"><span class="key-reveal">KEY: ${p1.toUpperCase()}</span></span>`);
            div.innerHTML = `${text} <div class="hint-box">Nghĩa: ${item.h}</div>`;
            list.appendChild(div);
        });
    }

    function sync() {
        let now = player.getCurrentTime();
        quiz.forEach((item, i) => {
            if (now >= item.s && now <= item.e) {
                document.querySelectorAll('.sentence').forEach(s => s.classList.remove('active'));
                const el = document.getElementById('s' + i);
                el.classList.add('active');
                if (item.t.includes('[') && !el.dataset.stopped) { player.pauseVideo(); el.dataset.stopped = true; }
            }
        });
    }

    function gradeWork() {
        const inputs = document.querySelectorAll('input');
        let score = 0;
        inputs.forEach(input => {
            let user = input.value.trim().toLowerCase();
            let correct = input.dataset.ans.toLowerCase();
            let reveal = input.nextElementSibling;
            if (user === correct) {
                input.className = 'correct'; reveal.style.display = 'none'; score++;
            } else {
                input.className = 'wrong'; reveal.style.display = 'inline-block';
            }
        });
        const scoreBox = document.getElementById('score-text');
        scoreBox.style.display = 'block';
        let percent = Math.round((score / inputs.length) * 100);
        scoreBox.innerText = `ĐIỂM CỦA BẠN: ${score} / ${inputs.length} (${percent}%)`;
    }
</script>
</body>
</html>
