<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>Learn Vocabulary Through Movie</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
body{
  margin:0; font-family:Poppins, sans-serif;
  background: linear-gradient(135deg,#fde2e4,#e0f2fe);
}
.container{
  display:grid; grid-template-columns: 1fr 1fr; gap:20px;
  padding:20px; max-width:1400px; margin:auto;
}
.video-box, .subtitle-box{
  background:#fff; border-radius:20px; padding:15px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
}
.subtitle-box{ max-height:420px; overflow-y:auto; }
.subtitle-line{
  padding:6px 10px; border-radius:10px; margin-bottom:6px;
}
.subtitle-line.active{
  background:linear-gradient(90deg,#a5f3fc,#fbcfe8);
  font-weight:600;
}
.quiz{
  grid-column:1/3; background:#fff; border-radius:20px;
  padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.15);
}
input.blank{
  border:none; border-bottom:2px solid #555; outline:none;
  width:120px; font-size:16px;
}
button{
  background:linear-gradient(90deg,#a5f3fc,#fbcfe8);
  border:none; padding:10px 20px; border-radius:30px;
  font-size:16px; cursor:pointer; margin-top:15px;
}
</style>
</head>
<body>

<div class="container">

  <!-- VIDEO -->
  <div class="video-box">
    <video id="video" width="100%" height="400" controls>
      <source src="https://docs.google.com/uc?export=download&id=1luLOxU-Vya_yTp678JZPVeCp0ebFbLfN" type="video/mp4">
    </video>
  </div>

  <!-- SUBTITLE -->
  <div class="subtitle-box" id="subtitleBox"></div>

  <!-- QUIZ -->
  <div class="quiz">
    <h2>üìù Vocabulary Quiz</h2>
    <div id="quizBox"></div>
    <button onclick="gradeQuiz()">Ch·∫•m ƒëi·ªÉm</button>
    <p id="result"></p>
  </div>

</div>

<script>
// === LOAD & PARSE SRT ===
const srtText = `1
00:00:01,000 --> 00:00:04,000
She brought a homeless man home.

2
00:00:05,000 --> 00:00:08,000
She had no idea he was a billionaire CEO.`;

function parseSRT(data){
  return data.trim().split(/\n\n+/).map(block=>{
    const lines = block.split('\n');
    const time = lines[1].split(' --> ');
    const toSec = t => {
      const [h,m,s] = t.replace(',',':').split(':');
      return (+h)*3600+(+m)*60+(+s);
    };
    return { start: toSec(time[0]), end: toSec(time[1]), text: lines.slice(2).join(' ') };
  });
}

const subtitles = parseSRT(srtText);

const subtitleBox = document.getElementById('subtitleBox');
subtitles.forEach((s,i)=>{
  const div=document.createElement('div');
  div.className='subtitle-line';
  div.id='line'+i;
  div.innerText=s.text;
  subtitleBox.appendChild(div);
});

// === SYNC VIDEO & SUBTITLE ===
const video = document.getElementById('video');
video.addEventListener('timeupdate',()=>{
  const t = video.currentTime;
  subtitles.forEach((s,i)=>{
    const line=document.getElementById('line'+i);
    if(t>=s.start && t<=s.end){
      line.classList.add('active');
      line.scrollIntoView({behavior:'smooth', block:'center'});
    } else line.classList.remove('active');
  });
});

// QUIZ from subtitles
const quizWords = ['homeless','billionaire'];
const quizBox = document.getElementById('quizBox');
quizWords.forEach((w,i)=>{
  quizBox.innerHTML += `<p>${i+1}. She met a <input class="blank" data-answer="${w}"> man.</p>`;
});

function gradeQuiz(){
  let score=0;
  document.querySelectorAll('.blank').forEach(i=>{
    if(i.value.toLowerCase().trim()===i.dataset.answer) score++;
  });
  document.getElementById('result').innerText = `ƒêi·ªÉm: ${score}/${quizWords.length}`;
}
</script>

</body>
</html>

